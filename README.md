based on https://github.com/wangchaohui/kotlin-lib